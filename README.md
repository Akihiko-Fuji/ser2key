# ser2key - シリアル入力をキーボード入力へ変換するツール 

## 🚀 概要  
**ser2key** は、シリアル入力をキーボードイベントに変換する軽量な Python ユーティリティです。受信したシリアルデータを検出し、それをキーストロークとしてシミュレートします。高い効率性を重視して設計されており、**システムトレイ**上でバックグラウンド動作します。日本語を含むQRコードに対して有効に機能します。

## ✨ 主な機能
- 🔧 **シリアル通信の柔軟な設定** – `config.ini` でボーレート、パリティ、タイムアウトなどを調整可能  
- ⌨️ **クリップボード経由のキーボード入力** – 受信データをペースト動作として入力  
- 🚀 **高速なデータ入力に対応** – 特に **日本語・中国語・韓国語** に強く、[既存ツール](https://www.keyence.co.jp/support/codereader/blsrus/soft/#d12)より高速  
- 🖥️ **システムトレイ連携** – ワンクリックで状態確認・設定変更可能

---

## ⚙️ 設定のヒント

### シリアルポート設定
`config.ini` の `[serial]` および `[settings]` セクションを編集することで、  
- デフォルトのポート  
- ボーレート  
- データ長  
- パリティ  
- ストップビット  
- 文字コード  
- 自動 Enter 挿入有無  

などを指定できます。  
これらの設定は実行中にもシステムトレイメニューから変更可能で、変更内容は `config.ini` に保存され、次回起動時に反映されます。

### 受信データの整形（ヘッダー・フッター）
`config.ini` の `[output]` セクションを使うと、受信したシリアルデータの前後に任意の文字列を追加できます。  
`header` はデータの前、`footer` は後に付加され、装置のファームウェアを変更せずに接頭辞・接尾辞や改行などを柔軟に追加可能です。

対応している特殊な記述：
- **エスケープシーケンス**  
  `\n`（改行）、`\r`（復帰）、`\t`（タブ）、`\u3001`（Unicode 文字）など

- **日時トークン**  
  `{DATE}` `{TIME}` `{DATETIME}` が利用可能。  
  コロン区切りで [Python `strftime` 形式](https://docs.python.org/3/library/datetime.html#strftime-and-strptime-format-codes) を指定できます。例：
  - `{DATE:%Y/%m/%d}`
  - `{TIME:%H時%M分%S秒}`

デフォルトの書式：
- `{DATE}` → `YYYY-MM-DD`  
- `{TIME}` → `HH:MM:SS`  
- `{DATETIME}` → `YYYY-MM-DD HH:MM:SS`

#### 設定例：
```ini
[output]
header={DATE:%Y%m%d}\t
footer=\r\n--\n
```

### パフォーマンスの強み

バーコードリーダーや QR コードリーダーの利用を想定して設計されており、多言語テキストの処理速度に優れています。
⚡ 特に 日本語・中国語・韓国語 の QR コード入力時には、Keyence AutoID Keyboard Wedge より数倍高速です。

### 💻 対応環境

✅ Windows（テスト済み）– システムトレイ対応
⚠️ その他の OS – トレイ機能の依存のため、動作には修正が必要。また、シリアル通信部分の動作確認は Windows 環境を前提としています。
🔌 あらゆるシリアルデバイスに対応 – Windows 上で COM ポートとして認識される RS-232C、USB シリアルアダプタ、Bluetooth SPP など。

### 🆙 更新履歴

1.3
システムトレイアイコンから接続する COM ポートを選択可能に対応。<BR>
Windows に特化し使用ライブラリを見直すことで実行ファイルサイズを縮小。

1.2
コード全体をリファクタリング。設定ファイルの異常値チェック機能を追加。

1.1
エラーハンドリングを強化。

1.0
初回リリース。

### 📥 ダウンロード

Windows x64 実行ファイルと設定ファイルを含みます。
📌 [ser2key.zip](https://github.com/Akihiko-Fuji/ser2key/raw/refs/heads/main/ser2key.zip)  
